<div class="login-container">
  <div class="login-left">
    <img src="/assets/hoc-tieng-nhat.jpg" alt="H·ªçc ti·∫øng Nh·∫≠t" />
  </div>

  <div class="login-right">
    <div class="login-box">
      <h2>Ch√†o m·ª´ng quay l·∫°i! üéå</h2>
      <p class="sub-text">C√πng √¥n luy·ªán ti·∫øng Nh·∫≠t n√†o~</p>
      <form id="loginForm">
        <div class="form-group">
          <label>H·ªç v√† T√™n</label>
          <input type="text" name="username" class="form-control" placeholder="Nh·∫≠p h·ªç t√™n" required>
        </div>
        <div class="form-group">
          <label>M·∫≠t kh·∫©u</label>
          <input type="password" name="password" class="form-control" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" required>
        </div>
        <button type="submit" class="btn-login">ƒêƒÉng nh·∫≠p</button>
      </form>
      <div class="text-small">
        Ch∆∞a c√≥ t√†i kho·∫£n? <a href="/auth/register">ƒêƒÉng k√Ω ngay</a>
      </div>
    </div>
  </div>
</div>

<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
/>

<style>
  body {
    margin: 0;
    font-family: "Poppins", "Noto Sans JP", sans-serif;
    background-color: #fffafc;
  }

  .login-container {
    display: flex;
    height: 100vh;
    width: 100vw;
    overflow: hidden;
  }

  /* ·∫¢nh b√™n tr√°i tr√†n full m√†n h√¨nh */
  .login-left {
    flex: 1;
    background-color: #fff5f7;
    display: flex;
    justify-content: center;
    align-items: center;
  }

.login-left img {
  width: 100%;
  height: 100%;
  object-fit: contain; /* gi·ªØ nguy√™n t·ª∑ l·ªá ·∫£nh, kh√¥ng b·ªã c·∫Øt */
  object-position: left center; /* canh ·∫£nh s√°t b√™n tr√°i */
  border-radius: 0;
  background-color: #fff; /* n·∫øu ·∫£nh kh√¥ng full chi·ªÅu cao th√¨ n·ªÅn tr·∫Øng l·∫•p ch·ªó tr·ªëng */
}


  /* Form b√™n ph·∫£i */
  .login-right {
    flex: 1;
    position: relative;
    background: url("/assets/hoc-tieng-nhat.jpg") center/cover no-repeat;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* ‚úÖ Th√™m l·ªõp m·ªù m·ªù ph√≠a sau form */
  .login-right::before {
    content: "";
    position: absolute;
    inset: 0;
    backdrop-filter: blur(12px) brightness(1.1);
    background-color: rgba(255, 255, 255, 0.6);
  }

  .login-box {
    position: relative;
    z-index: 2;
    background: rgba(255, 255, 255, 0.85);
    border-radius: 25px;
    padding: 40px 50px;
    width: 85%;
    max-width: 380px;
    box-shadow: 0 15px 40px rgba(255, 105, 180, 0.2);
    text-align: center;
    animation: fadeIn 0.8s ease;
    backdrop-filter: blur(8px);
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .login-box h2 {
    color: #ff66a3;
    font-weight: 700;
  }

  .sub-text {
    color: #777;
    font-size: 15px;
    margin-bottom: 25px;
  }

  .form-group {
    text-align: left;
    margin-bottom: 18px;
  }

  .form-group label {
    font-size: 14px;
    color: #444;
    margin-bottom: 5px;
    display: block;
  }

  .form-control {
    width: 100%;
    padding: 10px 14px;
    border: 2px solid #ffe3ec;
    border-radius: 12px;
    transition: 0.3s;
    font-size: 15px;
    background-color: rgba(255, 255, 255, 0.9);
  }

  .form-control:focus {
    border-color: #ff8fc7;
    outline: none;
    box-shadow: 0 0 5px rgba(255, 167, 196, 0.4);
  }

  .btn-login {
    background: linear-gradient(90deg, #ff8fc7, #ffa4d2);
    color: white;
    border: none;
    padding: 10px;
    border-radius: 12px;
    width: 100%;
    font-weight: 600;
    transition: 0.3s;
  }

  .btn-login:hover {
    opacity: 0.9;
    transform: translateY(-2px);
  }

  .text-small {
    font-size: 14px;
    color: #666;
    margin-top: 15px;
  }

  .text-small a {
    color: #ff66a3;
    text-decoration: none;
    font-weight: 600;
  }

  .text-small a:hover {
    text-decoration: underline;
  }

  /* üì± Responsive */
  @media (max-width: 900px) {
    .login-container {
      flex-direction: column;
    }

    .login-left {
      height: 40vh;
    }

    .login-right {
      height: 60vh;
    }

  

    .login-right::before {
      backdrop-filter: blur(6px);
    }
  }
</style>

<script>
    $(document).ready(function () {
        // Reset tr·∫°ng th√°i l·ªói khi ng∆∞·ªùi d√πng b·∫Øt ƒë·∫ßu nh·∫≠p
        $('input').on('input', function () {
            $(this).removeClass('is-invalid');
            $(this).next('.invalid-feedback').hide();
        });

        $('#loginForm').on('submit', function (e) {
            e.preventDefault();

            // Reset t·∫•t c·∫£ tr·∫°ng th√°i l·ªói
            $('input').removeClass('is-invalid');
            $('.invalid-feedback').hide();

            const formData = {
                username: $('input[name="username"]').val(),
                password: $('input[name="password"]').val()
            };

            // Ki·ªÉm tra t·ª´ng tr∆∞·ªùng
            let hasError = false;
            if (!formData.username) {
                $('input[name="username"]').addClass('is-invalid')
                    .after('<div class="invalid-feedback">Vui l√≤ng nh·∫≠p t√™n</div>');
                hasError = true;
            }
            if (!formData.password) {
                $('input[name="password"]').addClass('is-invalid')
                    .after('<div class="invalid-feedback">Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u</div>');
                hasError = true;
            }

            if (hasError) return;

            $.ajax({
                url: '/auth/login',
                type: 'POST',
                data: formData,
                success: function (response) {
                    window.location.href = '/';
                },
                error: function (xhr) {
                    const error = xhr.responseJSON?.error || 'L·ªói ƒëƒÉng nh·∫≠p';
                    if (xhr.responseJSON?.details) {
                        // Hi·ªÉn th·ªã l·ªói chi ti·∫øt cho t·ª´ng tr∆∞·ªùng
                        Object.entries(xhr.responseJSON.details).forEach(([field, message]) => {
                            if (message) {
                                $(`input[name="${field}"]`).addClass('is-invalid')
                                    .after(`<div class="invalid-feedback">${message}</div>`);
                            }
                        });
                    } else {
                        alert(error);
                    }
                }
            });
        });
    });
</script>